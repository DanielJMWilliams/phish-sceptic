@inject IDialogService DialogService

<DashboardItem Title="Link Inspector" Description="This component analyses all of the links in the email body.">
    <ComponentBody>
        @if (urls.Count() > 0)
        {
            <MudPaper Elevation="1" Class="my-5 pa-4">

                <MudGrid Spacing="1" Justify="Justify.Center">
                    <MudItem lg="3" md="6">
                        <MudStack>
                            <MudText># of links</MudText>
                            <MudPaper Elevation="4" Outlined Class="d-flex align-center" Height="120px" Width="120px">
                            <MudText Align="Align.Center" Typo="Typo.h2" Style="width:100%;">@urls.Count() </MudText>
                            </MudPaper>
                            </MudStack>

                            </MudItem>
                            <MudItem lg="3" md="6">
                            <MudStack>
                            <MudText># of domains</MudText>
                            <MudPaper Elevation="4" Outlined Class="d-flex align-center" Height="120px" Width="120px">
                            <MudText Align="Align.Center" Typo="Typo.h2" Style="width:100%;">@domains.Count() </MudText>
                            </MudPaper>
                            </MudStack>

                            </MudItem>
                            <MudItem lg="3" md="6">
                            <MudStack>
                            <MudText># of shortened links</MudText>
                            <MudTooltip Text="Attackers sometimes disguise malicious links with shortened URLs"
                                            Arrow Placement="Placement.Right">
                            <MudPaper Elevation="4" Outlined Class="d-flex align-center" Height="120px" Width="120px">
                                <MudText Color="@((shortenedDomains.Count()>0) ? Color.Error : Color.Default)" Align="Align.Center" Typo="Typo.h2" Style="width:100%;">@shortenedDomains.Count() </MudText>
                                </MudPaper>
                                </MudTooltip>
                                </MudStack>

                                </MudItem>
                                <MudItem lg="3" md="6">
                                <MudStack>
                                <MudText># of links containing anchors</MudText>
                                <MudTooltip Text="Attackers can manipulate URL anchors maliciously."
                                            Arrow Placement="Placement.Right">
                            <MudPaper Elevation="4" Outlined Class="d-flex align-center" Height="120px" Width="120px">
                                <MudText Color="@((urlsContainingAnchors.Count()>0) ? Color.Error : Color.Default)" Align="Align.Center" Typo="Typo.h2" Style="width:100%;">@urlsContainingAnchors.Count() </MudText>
                                </MudPaper>
                                </MudTooltip>
                                </MudStack>

                                </MudItem>
                                </MudGrid>

                                <MudDivider Class="my-4"></MudDivider>

                                <MudText Typo="Typo.h6">Domains referenced in email body:</MudText>
                                <MudText Color="Color.Info">Info: Click on each of the domains to verify them.</MudText>
                                @for (int i = 0; i < domains.Count(); i++)
                {
                    var index = i;

                    string tip = "This domain's reputation is yet to be checked'";
                    if (domainChipIcons[index] == Icons.Material.Filled.Dangerous)
                    {
                        tip = "This domain has been flagged as dangerous by VirusTotal.";
                    }
                    else if (domainChipIcons[index] == Icons.Material.Filled.WarningAmber)
                    {
                        tip = "This domain has not been scanned before";
                    }
                    else if (domainChipIcons[index] == Icons.Material.Filled.Check)
                    {
                        tip = "This domain is though to be safe by VirusTotal";
                    }

                    <MudTooltip Text="@tip">
                        <MudChip Icon="@domainChipIcons[index]" IconColor="@domainChipColors[index]"
                         OnClick="() => VerifyDomain(index)">
                            @domains[index]
                        </MudChip>

                    </MudTooltip>


                }

            </MudPaper>
        }
        else
        {
            <MudText Color="Color.Info" Align="Align.Center">This email contains no links.</MudText>
        }
    </ComponentBody>
    <ComponentHelp>
        <LinkInspectorHelp/>
    </ComponentHelp>

</DashboardItem>



