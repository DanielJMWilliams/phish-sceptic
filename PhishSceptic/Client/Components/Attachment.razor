@using MimeKit
@inject IDialogService DialogService

<MudPaper Class="d-flex justify-center">
    <MudButton OnClick="@ScanFile">
        <MudIcon Icon="@Icons.Material.Filled.InsertDriveFile" />
        <MudText>@Filename</MudText>
    </MudButton>

</MudPaper>


@code {
    [Parameter] public string Filename { get; set; }
    [Parameter] public MimeEntity FileEntity { get; set; }

    [Inject] IVirusTotalService vtService { get; set; }

    private async Task ScanFile()
    {
        
        var parameters = new DialogParameters();
        //parameters.Add("ContentText", "Verify that this domain really is what you think it is.");

        var options = new DialogOptions() { CloseButton = true, MaxWidth = MaxWidth.ExtraSmall };

        var dialog = await DialogService.ShowAsync<FileScanDialog>("Scan File", parameters, options);


        var result = await dialog.Result;

        if (result.Canceled)
        {
            return;
        }
        else
        {
            Scan();
        }




        StateHasChanged();
    }

    private async Task Scan()
    {
        var res = await vtService.ScanFile(FileEntity);
        Console.WriteLine("res" + res);
    }
}
