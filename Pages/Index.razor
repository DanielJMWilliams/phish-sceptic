@using MudBlazor
@using System
@page "/"
@inject ISnackbar Snackbar

<PageTitle>Index</PageTitle>

@if (emailAnalyser==null)
{
    <HomePage UploadFile=@uploadFile></HomePage>
}
else{
    <MudButton Color="Color.Error" OnClick="@startOver">Restart</MudButton>
    <MudListItem Icon="@Icons.Material.Filled.AttachFile" @key="@emailAnalyser">
        Uploaded: @emailAnalyser.GetFileName() <code>@emailAnalyser.GetFileSize() bytes</code>
    </MudListItem>

    <MudDivider Class="my-5"></MudDivider>

    <QuestionBox emailAnalyser="@emailAnalyser"></QuestionBox>    
}

@code
{
    private EmailAnalyser emailAnalyser;
    private async Task uploadFile(IBrowserFile file)
    {
        emailAnalyser = new EmailAnalyser(file);
        await emailAnalyser.Analyse();
        //await AnalyseEmail();
        StateHasChanged();
    }

    private void startOver()
    {
        //reset();
        emailAnalyser = null;
    }


    
}